import { TextField, Typography, Box, Stack, Button, Input } from '@mui/material'
import Card from '../../components/Card'
import { useState } from 'react'
import axios from 'axios'

function MyFilePicker({setFile}) {
  const [selectedFile, setSelectedFile] = useState(null)
  const handleChange = (event) => {
    setSelectedFile(event.target.files[0])
  }

  return (
    <Stack direction={'row'} spacing={2}>
      <input
        id="file-picker"
        type="file"
        onChange={handleChange}
        inputProps={{ sx: { border: 'none' } }}
      />
      <Typography>{selectedFile}</Typography>
    </Stack>
  )
}

const UserInput = () => {
  const [file, setFile] = useState(null);
  const [inputText, setInputText] = useState('');
  const [answer, setAnswer] = useState('');

  const handleSubmit = async () => {
    try {
      let formData = new FormData();
      formData.append('file', file);
      formData.append('text', inputText);
    
      const response = await axios.post('', formData);
      setAnswer(response.data.answer);
    }
    catch(error) {
      console.error('Error submitting input:', error)
    }
  }
  return (
    <Card>
      <Typography gutterBottom fontWeight={'bold'}>
        Input
      </Typography>
      <TextField
        placeholder="Paste your text here..."
        multiline
        minRows={8}
        borderColor="#C1B9F0"
        sx={{
          width: '100%',
          background: '#fcfcfc',
        }}
      ></TextField>
      <Box height={'15px'} />
      <Stack direction={'row'} spacing={2} justifyContent={'space-between'}>
        <MyFilePicker />
        <Button
          onClick={handleSubmit}
          size="small"
          variant="contained"
          sx={{ fontSize: '10px', padding: '5px' }}
        >
          process text
        </Button>
      </Stack>
      {answer && (<Box mt={2}>
        <Typography>
          {answer}
        </Typography>
      </Box>) }
    </Card>
  )
}
export default UserInput
